# -----------------------------------------------------------------------------
# ìž‘ì„±ìž : í•œì¤€êµ
# ìž‘ì„±ëª©ì  : ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ ì‹œ Listì™€ Generatorì˜ ë©”ëª¨ë¦¬ íš¨ìœ¨ì„± ë¹„êµ ì‹¤ìŠµ
# ìž‘ì„±ì¼ : 2025-01-12
#
# ë³¸ íŒŒì¼ì€ KDT êµìœ¡ì„ ìœ„í•œ Sample ì½”ë“œì´ë¯€ë¡œ ìž‘ì„±ìžì—ê²Œ ëª¨ë“  ì €ìž‘ê¶Œì´ ìžˆìŠµë‹ˆë‹¤.
#
# [ë³€ê²½ì´ë ¥]
# 2025-01-12 : ì´ˆê¸° í…œí”Œë¦¿ ìž‘ì„± ë° í™˜ê²½ êµ¬ì„±
# 2025-01-12 : 100ë§Œ ê°œ ì •ìˆ˜ ë¦¬ìŠ¤íŠ¸ ìƒì„± ë° ë©”ëª¨ë¦¬ ì¸¡ì • ë¡œì§ êµ¬í˜„
# 2025-01-12 : yield í‚¤ì›Œë“œë¥¼ í™œìš©í•œ ì œë„ˆë ˆì´í„° í•¨ìˆ˜ êµ¬í˜„ ë° ì„±ëŠ¥ ë¹„êµ ë¡œì§ ì¶”ê°€
# -----------------------------------------------------------------------------

# [Imports] ì‹œìŠ¤í…œ ê´€ë ¨ ëª¨ë“ˆ
import sys

# -----------------------------------------------------------------------------
# [Data Definition]
# - ì „ì—­ ë³€ìˆ˜, ìƒìˆ˜(Constants), ì‹¤ìŠµìš© ë°ì´í„°ì…‹ ë“±ì„ ì •ì˜í•˜ëŠ” êµ¬ì—­ìž…ë‹ˆë‹¤.
# -----------------------------------------------------------------------------
TARGET_COUNT = 1_000_000  # ì²˜ë¦¬í•  ë°ì´í„° ê°œìˆ˜ (100ë§Œ ê°œ)


# -----------------------------------------------------------------------------
# [Helper Functions]
# - ë©”ì¸ ë¡œì§ì„ ë³´ì¡°í•˜ëŠ” ë‹¨ìˆœ ê¸°ëŠ¥, í¬ë§·íŒ…, ìœ í‹¸ë¦¬í‹° í•¨ìˆ˜ë“¤ì„ ì •ì˜í•©ë‹ˆë‹¤.
# -----------------------------------------------------------------------------

def print_section_title(title):
    """
    ì¶œë ¥ ê²°ê³¼ì˜ ê°€ë…ì„±ì„ ë†’ì´ê¸° ìœ„í•´ ì„¹ì…˜ ì œëª©ì„ êµ¬ë¶„ì„ ê³¼ í•¨ê»˜ ì¶œë ¥í•©ë‹ˆë‹¤.
    """
    print(f"\n" + "="*60)
    print(f" [Step] {title}")
    print("="*60)


def get_size_info(obj, name):
    """
    ê°ì²´ì˜ ë©”ëª¨ë¦¬ í¬ê¸°ë¥¼ ì¸¡ì •í•˜ì—¬ ì¶œë ¥í•˜ê¸° ì¢‹ì€ ë¬¸ìžì—´ë¡œ ë°˜í™˜í•©ë‹ˆë‹¤.
    
    Args:
        obj: ë©”ëª¨ë¦¬ë¥¼ ì¸¡ì •í•  ê°ì²´
        name: ê°ì²´ì˜ ì´ë¦„ (ì‹ë³„ìš©)
    
    Returns:
        None (ë‚´ë¶€ì—ì„œ print ìˆ˜í–‰)
    """
    size_bytes = sys.getsizeof(obj)
    # ê°€ë…ì„±ì„ ìœ„í•´ MB ë‹¨ìœ„ë¡œë„ ë³€í™˜í•˜ì—¬ í‘œì‹œ (1 MB = 1024 * 1024 bytes)
    size_mb = size_bytes / (1024 * 1024)
    print(f" -> '{name}' ê°ì²´ì˜ ë©”ëª¨ë¦¬ ì ìœ ìœ¨: {size_bytes:,} bytes ({size_mb:.2f} MB)")


# -----------------------------------------------------------------------------
# [Business Logic Functions]
# - ì‹¤ì œ ìš”êµ¬ì‚¬í•­ì„ ì²˜ë¦¬í•˜ëŠ” í•µì‹¬ ì•Œê³ ë¦¬ì¦˜ ë° ë°ì´í„° ì²˜ë¦¬ í•¨ìˆ˜ë“¤ì„ ì •ì˜í•©ë‹ˆë‹¤.
# -----------------------------------------------------------------------------

def create_large_list(n):
    """
    0ë¶€í„° n-1ê¹Œì§€ì˜ ìˆ«ìžë¥¼ ë¯¸ë¦¬ ìƒì„±í•˜ì—¬ ë©”ëª¨ë¦¬ì— ëª¨ë‘ ì ìž¬í•˜ëŠ” ë¦¬ìŠ¤íŠ¸ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
    (Eager Evaluation)

    Args:
        n (int): ìƒì„±í•  ìˆ«ìžì˜ ê°œìˆ˜

    Returns:
        list: 0 ~ n-1 ê¹Œì§€ì˜ ì •ìˆ˜ê°€ ë‹´ê¸´ ë¦¬ìŠ¤íŠ¸
    """
    # ë¦¬ìŠ¤íŠ¸ ì»´í”„ë¦¬í—¨ì…˜ì„ ì‚¬ìš©í•˜ì—¬ 0ë¶€í„° n-1ê¹Œì§€ ë‹´ê¸´ ë¦¬ìŠ¤íŠ¸ ìƒì„±
    return [i for i in range(n)]


def number_generator(n):
    """
    0ë¶€í„° n-1ê¹Œì§€ì˜ ìˆ«ìžë¥¼ 'í•„ìš”í•  ë•Œë§ˆë‹¤ í•˜ë‚˜ì”©' ìƒì„±í•˜ëŠ” ì œë„ˆë ˆì´í„°ë¥¼ ë°˜í™˜í•©ë‹ˆë‹¤.
    (Lazy Evaluation)

    Args:
        n (int): ìƒì„±í•  ìˆ«ìžì˜ ê°œìˆ˜

    Yields:
        int: í˜¸ì¶œ ì‹œë§ˆë‹¤ ìƒì„±ë˜ëŠ” ìˆ«ìž
    """
    for i in range(n):
        yield i  # ê°’ì„ ë°˜í™˜í•˜ê³  ìž ì‹œ ëŒ€ê¸°(suspend) ìƒíƒœê°€ ë¨


def process_sum(iterable_obj):
    """
    ë°˜ë³µ ê°€ëŠ¥í•œ ê°ì²´(Iterable)ë¥¼ ë°›ì•„ ì´í•©ì„ ê³„ì‚°í•©ë‹ˆë‹¤.
    
    Args:
        iterable_obj: list ë˜ëŠ” generator ë“± ë°˜ë³µ ê°€ëŠ¥í•œ ê°ì²´
    
    Returns:
        int: ìš”ì†Œë“¤ì˜ ì´í•©
    """
    return sum(iterable_obj)


# -----------------------------------------------------------------------------
# [Main Execution Flow]
# - ìŠ¤í¬ë¦½íŠ¸ ì‹¤í–‰ ì‹œ ìˆ˜í–‰ë˜ëŠ” ë©”ì¸ ì§„ìž…ì (Entry Point)ìž…ë‹ˆë‹¤.
# -----------------------------------------------------------------------------
if __name__ == "__main__":
    print(f">>> í”„ë¡œê·¸ëž¨ ì‹¤í–‰ ì‹œìž‘ (ì²˜ë¦¬ ë°ì´í„°: {TARGET_COUNT:,}ê°œ)")

    # ---------------------------------------------------------
    # 1. ì¼ë°˜ ë¦¬ìŠ¤íŠ¸(List) ë°©ì‹ ì‹¤ìŠµ
    # ---------------------------------------------------------
    print_section_title("1. ì¼ë°˜ ë¦¬ìŠ¤íŠ¸(List) ë°©ì‹ í…ŒìŠ¤íŠ¸")
    
    # ë¦¬ìŠ¤íŠ¸ ìƒì„± (ì´ ì‹œì ì— 100ë§Œ ê°œ ìˆ«ìžê°€ ë©”ëª¨ë¦¬ì— ë‹¤ ì˜¬ë¼ê°)
    my_list = create_large_list(TARGET_COUNT)
    get_size_info(my_list, "my_list")
    
    # ì´í•© ê³„ì‚°
    list_sum = process_sum(my_list)
    print(f" -> ë¦¬ìŠ¤íŠ¸ ì´í•© ê²°ê³¼: {list_sum:,}")


    # ---------------------------------------------------------
    # 2. ì œë„ˆë ˆì´í„°(Generator) ë°©ì‹ ì‹¤ìŠµ
    # ---------------------------------------------------------
    print_section_title("2. ì œë„ˆë ˆì´í„°(Generator) ë°©ì‹ í…ŒìŠ¤íŠ¸")

    # ì œë„ˆë ˆì´í„° ìƒì„± (ì•„ì§ ìˆ«ìžëŠ” í•˜ë‚˜ë„ ë§Œë“¤ì–´ì§€ì§€ ì•ŠìŒ, ìƒì„± ê·œì¹™ë§Œ ì €ìž¥)
    my_gen = number_generator(TARGET_COUNT)
    get_size_info(my_gen, "my_gen")

    # ì´í•© ê³„ì‚° (ì´ë•Œ next()ê°€ í˜¸ì¶œë˜ë©´ì„œ ìˆ«ìžê°€ í•˜ë‚˜ì”© ìƒì„±ë˜ê³  ë”í•´ì§)
    gen_sum = process_sum(my_gen)
    print(f" -> ì œë„ˆë ˆì´í„° ì´í•© ê²°ê³¼: {gen_sum:,}")


    # ---------------------------------------------------------
    # 3. ê²°ê³¼ ë¹„êµ ë° ë¶„ì„
    # ---------------------------------------------------------
    print_section_title("3. ìµœì¢… ë¹„êµ ë¶„ì„")
    
    size_list = sys.getsizeof(my_list)
    size_gen = sys.getsizeof(number_generator(TARGET_COUNT)) # í¬ê¸° ë¹„êµë¥¼ ìœ„í•´ ìž¬ìƒì„±

    diff_ratio = int(size_list / size_gen)

    print(f"âœ… ê²°ê³¼ ê²€ì¦: ë‘ ë°©ì‹ì˜ ì´í•©ì´ ê°™ì€ê°€? {list_sum == gen_sum}")
    print(f"ðŸ“‰ ë©”ëª¨ë¦¬ ì ˆê°: ì œë„ˆë ˆì´í„°ëŠ” ë¦¬ìŠ¤íŠ¸ë³´ë‹¤ ì•½ [{diff_ratio:,}ë°°] ë” ì ì€ ë©”ëª¨ë¦¬ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤.")
    print("\n[ê²°ë¡ ] ì œë„ˆë ˆì´í„°ëŠ” ë°ì´í„°ë¥¼ í•œêº¼ë²ˆì— ë©”ëª¨ë¦¬ì— ì˜¬ë¦¬ì§€ ì•Šê³ ,")
    print("       'ìš”ì²­ì´ ì˜¬ ë•Œë§ˆë‹¤(Yield)' ê°’ì„ ìƒì„±í•˜ë¯€ë¡œ ëŒ€ìš©ëŸ‰ ë°ì´í„° ì²˜ë¦¬ì— í•„ìˆ˜ì ìž…ë‹ˆë‹¤.")

    print("\n>>> í”„ë¡œê·¸ëž¨ ì‹¤í–‰ ì¢…ë£Œ")